webpackJsonp([3,1],{0:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var o=n(11),r=a(o);n(107),n(109);var u=n(20),i=a(u);n(295);var s=n(301),l=a(s),c=n(307),d=a(c),f=n(41),p=a(f);p.default.checkLogin().then(function(t){if(t){var e=d.default.data;d.default.data=function(){return(0,r.default)({},e(),{userData:t})}}l.default.start(d.default,"#app")}),console.info("[当前环境] 生产环境"),i.default.config.devtools=!1},19:function(t,e,n){(function(e){var a=n(106),o="db.json",r=n(93);o=r.join(e,o);var u=a(o);u.defaults({msgs:[],session:null}).value(),t.exports=u}).call(e,"/")},40:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(11),r=a(o),u=n(303),i=a(u),s=n(302),l=a(s);e.default=(0,r.default)({"*":{component:{init:function(){window.swal({type:"warning",title:"404 NOT FOUND",timer:2e3,showConfirmButton:!1}),history.back()},template:"<span></span>"}},"/redirect":{component:{init:function(){this.$router.replace({path:decodeURIComponent(this.$route.query.dest||"/"),force:!0})},template:"<span></span>"}},"/":{title:"首页",icon:"fa fa-home",showInNavbar:{exact:!0},showInSidebar:!0,component:function(t){n.e(0,function(e){var n=[e(317)];t.apply(null,n)}.bind(this))}}},i.default,l.default)},41:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(76),r=a(o),u=n(77),i=a(u),s=n(81),l=a(s),c=function(){function t(){(0,r.default)(this,t)}return(0,i.default)(t,[{key:"checkLogin",value:function(){return(0,l.default)({url:"/auth/checkLogin"})}},{key:"login",value:function(t){return(0,l.default)({method:"post",url:"/auth/login",body:t})}},{key:"logout",value:function(){return(0,l.default)({method:"delete",url:"/auth/logout"})}}]),t}();e.default=new c},81:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(305).default;a=n(85),e.default=a},82:function(t,e){"use strict";function n(t){return t?t.split("?")[0]:""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},85:function(t,e,n){window._=n(266);var a=n(95),o=n(74),r=n(92),u=n(89),i=n(91),s=n(90),l=a();l.use(i),l.use(s),l.use(r),l.use(u);var c=function(t){console.group("Mock Server");var e=(t.method||"GET").toUpperCase(),n=t.body,a=t.url,r=a.split("?"),u=r[0],i=o.parse(r[1]);if("GET"===e&&n){Object.assign(i,n);var s=o.stringify(i);a=s?u+"?"+s:a}return new Promise(function(t){l.receive({method:e,url:a,body:n||{}}).respond(function(e){return"string"==typeof e&&(e=JSON.parse(e)),e.success?(t(e.data),void console.groupEnd("Mock Server")):alert(e.errMsg)})})};t.exports=c},86:function(t,e,n){var a=n(19);e.checkLogin=function(t,e){e.ajaxReturn(a.get("session").value())},e.login=function(t,e){var n=(t.body.username||"").trim();if(!n)return e.ajaxReturn(!1,{errMsg:"username 字段为空"});var o={username:n};a.set("session",o).value(),e.ajaxReturn(o)},e.logout=function(t,e){a.set("session",null).value(),e.ajaxReturn()}},87:function(t,e,n){var a=n(172),o=n(19);e.getList=function(t,e){var n=t.query.authors,a=~~t.query.offset||0,r=~~t.query.limit||5,u=o.get("msgs");n&&(n=n.split(","),u=u.filter(function(t){return n.indexOf(t.author)!==-1})),e.ajaxReturn({total:u.size().value(),rows:u.orderBy("ctime","desc").slice(a,a+r).value()})},e.add=function(t,e){return t.body.title&&t.body.content?(t.body.id=a().substr(0,8),t.body.author=o.get("session.username").value(),t.body.ctime=Date.now(),void e.ajaxReturn(o.get("msgs").push(t.body).last().value())):e.ajaxReturn(!1,{errMsg:"title 或 content 字段为空"})},e.authors=function(t,e){e.ajaxReturn(o.get("msgs").map("author").uniq().value())},e.getById=function(t,e){var n=o.get("msgs").find({id:t.params.msgId}).value();return n?e.ajaxReturn(n):void e.ajaxReturn(!1,{errMsg:"不存在该留言信息"})},e.update=function(t,e){delete t.body.id,delete t.body.author,t.body.ctime=Date.now();var n=o.get("msgs").find({id:t.params.msgId,author:o.get("session.username").value()});return n.isEmpty().value()?e.ajaxReturn(!1,{errMsg:"修改失败"}):void e.ajaxReturn(n.assign(t.body).value())},e.remove=function(t,e){var n=o.get("msgs").remove({id:t.params.msgId,author:o.get("session.username").value()}).value()[0];return n?e.ajaxReturn(n):void e.ajaxReturn(!1,{errMsg:"删除失败"})}},88:function(t,e,n){function a(t,e){return function(n,a,r){!o.get("session").isEmpty().value()===t?r():a.ajaxReturn(!1,{errMsg:e})}}var o=n(19);t.exports={NEED_AUTH:a(!0,"您需要登录后才能进行该操作"),FORBID_AUTHED:a(!1,"您已经登录，禁止当前操作")}},89:function(t,e){t.exports=function(t,e){e.ajaxReturn(!1,{errMsg:"404 NOT FOUND"})}},90:function(t,e){t.exports=function(t,e,n){e.ajaxReturn=function(t,n){e.json(Object.assign({success:!!t||!n,errMsg:"",data:t||""},n))},n()}},91:function(t,e){t.exports=function(t,e,n){console.info("[Logger]",t.method,t.originalUrl),n()}},92:function(t,e,n){var a=n(87),o=n(86),r=n(88);t.exports=[{path:"/msg",method:"GET",handler:a.getList},{path:"/msg",method:"POST",middlewares:[r.NEED_AUTH],handler:a.add},{path:"/msg/authors",method:"GET",handler:a.authors},{path:"/msg/:msgId",method:"GET",handler:a.getById},{path:"/msg/:msgId",method:"PUT",middlewares:[r.NEED_AUTH],handler:a.update},{path:"/msg/:msgId",method:"DELETE",middlewares:[r.NEED_AUTH],handler:a.remove},{path:"/auth/checkLogin",method:"GET",handler:o.checkLogin},{path:"/auth/login",method:"POST",middlewares:[r.FORBID_AUTHED],handler:o.login},{path:"/auth/logout",method:"DELETE",middlewares:[r.NEED_AUTH],handler:o.logout}]},109:function(t,e){},110:109,112:109,113:109,121:function(t,e){t.exports=' <div> <navbar></navbar> <div class="row m-0 p-5"> <div class="col-md-2 col-sm-3 col-xs-12"> <sidebar></sidebar> </div> <div class="col-md-10 col-sm-9 col-xs-12"> <breadcrumb></breadcrumb> <div class="main-content p-15"> <router-view transition=fade transition-mode=out-in></router-view> </div> </div> </div> </div> '},122:function(t,e){t.exports=' <ul class="breadcrumb clearfix"> <i class="fa fa-map-marker m-r-5"></i> <li v-for="route in matchedRoutes" :class="{ \'active\': $index === matchedRoutes.length - 1 }"> <span v-if="$index === matchedRoutes.length - 1"> {{ route.handler.title }} </span> <a v-else v-link=route.handler.fullPath> {{ route.handler.title }} </a> </li> <button @click=refresh class="btn btn-default btn-xs pull-right"> <i class="fa fa-refresh m-r-5"></i> 强制刷新 </button> <button @click=back class="btn btn-default btn-xs pull-right"> <i class="fa fa-reply m-r-5"></i> 返回 </button> </ul> '},123:function(t,e){t.exports=' <nav class="navbar navbar-default" id=navbar> <div class=navbar-header> <a class=navbar-brand v-link="`/`"> Vue Demo </a> </div> <ul class="nav navbar-nav"> <li v-for="route in routes" v-link-active> <a v-link="{\n          path: route.fullPath,\n          exact: route.showInNavbar.exact,\n          activeClass: \'active\'\n        }"> <i class="fa-lg m-r-5" :class="route.icon | defaultIcon"></i> </a> </li> </ul> <ul class="nav navbar-nav navbar-right m-r-5"> <li data-toggle=tooltip title=Github> <a href=https://github.com/kenberkeley/vue-demo target=_blank> <i class="fa fa-github fa-lg"></i> </a> </li> <li data-toggle=tooltip title=文档> <a href=docs target=_blank> <i class="fa fa-book fa-lg"></i> </a> </li> <li v-if=$root.userData class=dropdown> <a href=javascript:; class=dropdown-toggle data-toggle=dropdown> <i class="fa fa-user-secret fa-lg m-r-5"></i> {{ $root.userData.username }} <span class=caret></span> </a> <ul class=dropdown-menu> <li><a v-link="`/auth/logout`"> <i class="fa fa-sign-out fa-lg m-r-5"></i> 注销登录 </a></li> </ul> </li> <li v-else v-link-active> <a v-link="{ path: \'/auth/login\', activeClass: \'active\' }"> <i class="fa fa-sign-in fa-lg m-r-5"></i> 登录 </a> </li> </ul> </nav> '},127:function(t,e){t.exports=' <a class="btn btn-default btn-block m-t-0 vlink" :class="{ \'matched-route\': path === curMatchedPath }" v-link=vlinkContent> <i :class=icon class=m-r-5></i> {{ title }} </a> '},128:function(t,e){t.exports=' <div id=sidebar> <template v-for="route in routes"> <div v-if=route.subRoutes> <a :href="\'#panel\'+$index" class="btn btn-default btn-block" data-toggle=collapse data-parent=#sidebar> <i :class=route.icon class=m-r-5></i> {{ route.title }} <span class=caret></span> </a> <div :id="\'panel\'+$index" class="collapse w-90p m-0-auto"> <link v-for="subRoute in route.subRoutes" :path=subRoute.fullPath :title=subRoute.title :icon=subRoute.icon>  </div> </div> <link v-else :path=route.path :title=route.title :icon=route.icon :is-exact=true>  </template> </div> '},277:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(309),r=a(o),u=n(314),i=a(u),s=n(308),l=a(s);e.default={components:{Navbar:r.default,Sidebar:i.default,Breadcrumb:l.default},data:function(){return{userData:null}}}},278:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(82),r=a(o);e.default={computed:{matchedRoutes:function(){return this.$route.matched.slice()}},methods:{refresh:function(){var t=(0,r.default)(this.$route.path);this.$router.go("/redirect?dest="+t)},back:function(){history.back()}}}},279:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(40),r=a(o),u=n(38),i=a(u);e.default={computed:{routes:function(){return(0,i.default)(r.default,function(t){return t.showInNavbar})}},filters:{defaultIcon:function(t){return t?t:"fa fa-link"}},attached:function(){$(this.$el).find("[data-toggle=tooltip]").tooltip({placement:"bottom"})}}},283:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{path:{type:String,required:!0},title:{type:String,required:!0},icon:{type:String,default:"fa fa-link"},isExact:{type:Boolean,default:!1}},computed:{curMatchedRoute:function(){var t=this.$route.matched;return t[t.length-1]},curMatchedPath:function(){return this.curMatchedRoute.handler.fullPath},isDynamicPath:function(){return this.path.includes(":")},vlinkContent:function(){if(!this.isDynamicPath)return{path:this.path,exact:this.isExact}}},attached:function(){this.isDynamicPath&&$(this.$el).on("click",function(){return $.toast({heading:"动态路由不可直接点击访问",icon:"info",stack:!1})})}}},284:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(313),r=a(o),u=n(40),i=a(u),s=n(38),l=a(s);e.default={components:{Link:r.default},computed:{routes:function(){return(0,l.default)(i.default,function(t){return t.showInSidebar})}},watch:{"$route.path":function(){this.expand()}},attached:function(){this.expand()},methods:{expand:function(){$(this.$el).find("a.matched-route").parents("div.collapse").collapse("show")}}}},294:function(t,e){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return window.moment(t).format(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},295:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var o=n(20),r=a(o);r.default.filter("dateTimeFormatter",n(294).default)},296:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){var e=t.to.matched,n=[];e.slice().forEach(function(t){var e=t.handler.title;e&&n.push(e)}),document.title=n.join(" · ")};e.default=n},297:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(82),r=a(o),u=function(t){var e=t.to,n=t.from;(0,r.default)(e.path)!==(0,r.default)(n.path)&&$.scrollTo("#navbar",500)};e.default=u},298:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){var e=t.to,n=t.from,a=decodeURIComponent;console.info("[路由日志] "+a(n.path||"")+" => "+a(e.path))};e.default=n},299:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return function(e){var n=e.to,a=e.redirect,o=e.abort,r=e.next,u=t.app.userData,i=n.needAuth,s=n.forbidAuthed,l=n.path;return i&&!u?($.toast({heading:"访问该页面需要登录权限",text:"登录成功后将会自动跳转",icon:"info",stack:!1}),a({path:"/auth/login?referrer="+encodeURIComponent(l),force:!0})):s&&u?($.toast({heading:"您已登录，禁止访问该页面",text:"已中断跳转",icon:"warning",stack:!1}),o()):void r()}};e.default=n},300:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(299),r=a(o),u=n(296),i=a(u),s=n(297),l=a(s),c=n(298);a(c);e.default=function(t){t.beforeEach((0,r.default)(t)),t.afterEach(l.default),t.afterEach(i.default)}},301:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(20),r=a(o),u=n(108),i=a(u),s=n(40),l=a(s),c=n(300),d=a(c);r.default.use(i.default);var f=new i.default({suppressTransitionError:!0});f.map(l.default),f.alias({"/msg":"/msg/list"}),(0,d.default)(f),e.default=f},302:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={"/auth/login":{title:"用户登录",icon:"fa fa-sign-in",component:function(t){n.e(0,function(e){var n=[e(315)];t.apply(null,n)}.bind(this))},forbidAuthed:!0},"/auth/logout":{title:"注销登录",icon:"fa fa-sign-out",component:function(t){n.e(0,function(e){var n=[e(316)];t.apply(null,n)}.bind(this))},needAuth:!0}}},303:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={"/msg":{title:"留言板",icon:"fa fa-commenting-o",showInNavbar:!0,showInSidebar:!0,component:function(t){n.e(0,function(e){var n=[e(321)];t.apply(null,n)}.bind(this))},subRoutes:{"/list":{title:"列表",icon:"fa fa-list",component:function(t){n.e(0,function(e){var n=[e(322)];t.apply(null,n)}.bind(this))}},"/detail/:msgId":{title:"详情",icon:"fa fa-search-plus",component:function(t){n.e(0,function(e){var n=[e(320)];t.apply(null,n)}.bind(this))}},"/add":{title:"新增",icon:"fa fa-plus",component:function(t){n.e(0,function(e){var n=[e(319)];t.apply(null,n)}.bind(this))},needAuth:!0},"/update/:msgId":{title:"修改",icon:"fa fa-eraser",component:function(t){n.e(0,function(e){var n=[e(323)];t.apply(null,n)}.bind(this))},needAuth:!0}}}}},304:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.rootPath="/api",e.errHandler=function(t){$.toast({heading:"请求 API 失败",icon:"error",stack:!1}),console.warn(t)}},305:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(304),o=function(t){var e=t.method,n=void 0===e?"get":e,o=t.url,r=t.body,u=void 0===r?null:r,i=$.Deferred();return $.ajax({type:n,url:a.rootPath+o,data:u}).done(function(t){var e=t.success,n=t.errMsg,a=t.data;return e?void i.resolve(a):$.toast({heading:"操作失败",text:n,icon:"warning",stack:!1})}).fail(a.errHandler),i.promise()};e.default=o},307:function(t,e,n){var a,o,r={};n(110),a=n(277),o=n(121),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default);var u="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;o&&(u.template=o),u.computed||(u.computed={}),Object.keys(r).forEach(function(t){var e=r[t];u.computed[t]=function(){return e}})},308:function(t,e,n){var a,o,r={};a=n(278),o=n(122),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default);var u="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;o&&(u.template=o),u.computed||(u.computed={}),Object.keys(r).forEach(function(t){var e=r[t];u.computed[t]=function(){return e}})},309:function(t,e,n){var a,o,r={};a=n(279),o=n(123),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default);var u="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;o&&(u.template=o),u.computed||(u.computed={}),Object.keys(r).forEach(function(t){var e=r[t];u.computed[t]=function(){return e}})},313:function(t,e,n){var a,o,r={};n(112),a=n(283),o=n(127),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default);var u="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;o&&(u.template=o),u.computed||(u.computed={}),Object.keys(r).forEach(function(t){var e=r[t];u.computed[t]=function(){return e}})},314:function(t,e,n){var a,o,r={};n(113),a=n(284),o=n(128),t.exports=a||{},t.exports.__esModule&&(t.exports=t.exports.default);var u="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;o&&(u.template=o),u.computed||(u.computed={}),Object.keys(r).forEach(function(t){var e=r[t];u.computed[t]=function(){return e}})}});